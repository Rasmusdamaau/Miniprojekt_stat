---
title: "BJ"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Den 3. model

Først defineres $x_i$ og der generes der n $y_i$ obervationer, samt defineres $\beta^*$ som skal benyttes senere.

```{r}
n <- 20
x_i <- 1:n
y_i <- rnorm(n,mean = 0, sd=1)
bet.star <- 1.1
```

Der defineres først to funktioner, som bliver anvendelige senere
```{r}
a <- sum(bet.star^x_i)
b <- (sum(bet.star^x_i)/n)*sum(bet.star^x_i)
c <- (sum(bet.star^x_i)/n)*sum(y_i)
d <- sum(y_i*bet.star^x_i)

alpha <- (c-d)/(b-a)
gamma <- 1/n * sum(alpha*bet.star-y_i)

```

Målet er nu at estimere $\beta$ ved funktionen $\widehat{\beta}=\beta^*+j(\beta^*)^{-1}S(\beta^*)$, hvorfor $j(\beta^*)^{-1}$ og $S(\beta^*)$ defineres som funktioner

```{r}
i.bet <- function(bet.s){
  sum(x_i*alpha*bet.s^(x_i-2) * (2*x_i-1)*alpha*bet.s^x_i + gamma*(x_i-1) -
                                               y_i*(x_i-1))
}

s.bet <- function(bet.s){
  sum((alpha*bet.s^x_i+gamma-y_i)*alpha*bet.s^(x_i-1)*x_i)
}
```

Nu er alle variablene implementeret, så det er nu muligt at estimere beta

```{r}
while (abs(bet-bet.star)>0.01) {
  
}
```





